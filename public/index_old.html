<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI 뉴스 개인화 플랫폼 · VeraChain</title>
  <meta name="description" content="AI 기반 뉴스 개인화 엔진 API - VeraChain 생태계" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .badge { @apply inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium; }
    .gradient-bg { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); }
    .card-hover { transition: all 0.3s ease; }
    .card-hover:hover { transform: translateY(-2px); }
  </style>
</head>
<body class="bg-slate-950 text-slate-100 gradient-bg">
  <div class="min-h-screen flex flex-col">
    <header class="border-b border-slate-800/70 backdrop-blur-sm bg-slate-950/80">
      <div class="mx-auto max-w-6xl px-6 py-5 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="h-10 w-10 rounded-xl bg-gradient-to-br from-emerald-400 to-cyan-500 flex items-center justify-center">
            <svg class="w-6 h-6 text-slate-900" fill="currentColor" viewBox="0 0 20 20">
              <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </div>
          <div>
            <h1 class="text-xl font-bold">AI 뉴스 개인화 플랫폼</h1>
            <p class="text-xs text-slate-400">VeraChain Ecosystem</p>
          </div>
          <div class="flex gap-2">
            <span class="badge bg-slate-800 text-slate-300">v3.0.8</span>
            <span class="badge bg-emerald-900/40 text-emerald-300" id="env-badge">production</span>
          </div>
        </div>
        <a class="text-sm text-slate-300 hover:text-emerald-300 underline underline-offset-4 transition-colors" href="/status">JSON Status</a>
      </div>
    </header>

    <main class="flex-1">
      <section class="mx-auto max-w-6xl px-6 py-16">
        <div class="text-center">
          <h2 class="text-4xl md:text-6xl font-bold tracking-tight">
            뉴스를 <span class="text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 to-cyan-400">개인 맞춤형</span>으로<br>
            변환하는 AI
          </h2>
          <p class="mt-6 text-xl text-slate-300 max-w-3xl mx-auto">
            팩트 추출 → 사용자 분석 → 맞춤형 재구성까지 <span class="text-emerald-400 font-semibold">2초</span>에 완성.<br>
            <span class="text-slate-200">특허 기술</span> 기반 개인화 엔진으로 투자자 맞춤 뉴스 분석을 제공합니다.<br>
            <span class="text-xs text-slate-400">OpenAI GPT-4o-mini + Groq Llama 멀티 AI 지원</span>
          </p>
        </div>

        <div class="mt-12 grid md:grid-cols-3 gap-6">
          <div class="card-hover rounded-2xl border border-slate-800 bg-slate-900/40 backdrop-blur-sm p-6">
            <div class="flex items-center gap-3 mb-4">
              <div class="h-3 w-3 rounded-full bg-emerald-400"></div>
              <div class="text-sm text-slate-400">System Status</div>
            </div>
            <div id="uptime" class="text-2xl font-bold text-slate-100">—</div>
            <div class="text-sm text-slate-400">Uptime</div>
          </div>
          
          <div class="card-hover rounded-2xl border border-slate-800 bg-slate-900/40 backdrop-blur-sm p-6">
            <div class="flex items-center gap-3 mb-4">
              <div id="health-dot" class="h-3 w-3 rounded-full bg-slate-400"></div>
              <div class="text-sm text-slate-400">Health Check</div>
            </div>
            <div id="health" class="text-2xl font-bold text-slate-100">—</div>
            <div id="healthDetail" class="text-sm text-slate-400">Checking...</div>
          </div>
          
          <div class="card-hover rounded-2xl border border-slate-800 bg-slate-900/40 backdrop-blur-sm p-6">
            <div class="flex items-center gap-3 mb-4">
              <div class="h-3 w-3 rounded-full bg-cyan-400"></div>
              <div class="text-sm text-slate-400">API Endpoints</div>
            </div>
            <ul class="space-y-2">
              <li><a class="text-emerald-300 hover:text-emerald-200 text-sm underline transition-colors" href="/api/system/health">/api/system/health</a></li>
              <li><a class="text-emerald-300 hover:text-emerald-200 text-sm underline transition-colors" href="/api/news/articles">/api/news/articles</a></li>
            </ul>
          </div>
        </div>

        <div class="mt-16 grid md:grid-cols-3 gap-6">
          <div class="card-hover rounded-2xl border border-slate-800 bg-slate-900/40 backdrop-blur-sm p-6">
            <div class="text-slate-100 font-semibold text-lg">AI 팩트 추출</div>
            <p class="mt-2 text-slate-400">5W1H 구조화, 수치 데이터 분석, 인용문 정리로 핵심 정보만 추출합니다.</p>
          </div>
          
          <div class="card-hover rounded-2xl border border-slate-800 bg-slate-900/40 backdrop-blur-sm p-6">
            <div class="text-slate-100 font-semibold text-lg">개인화 엔진</div>
            <p class="mt-2 text-slate-400">투자자 프로필 기반 맞춤형 콘텐츠 재구성으로 최적화된 분석을 제공합니다.</p>
          </div>
          
          <div class="card-hover rounded-2xl border border-slate-800 bg-slate-900/40 backdrop-blur-sm p-6">
            <div class="text-slate-100 font-semibold text-lg">클라우드 인프라</div>
            <p class="mt-2 text-slate-400">MongoDB Atlas 연동, 확장 가능한 아키텍처로 안정적인 서비스를 보장합니다.</p>
          </div>
        </div>

        <div class="mt-16 rounded-3xl border border-emerald-800/30 bg-gradient-to-br from-emerald-950/40 to-cyan-950/20 p-8 backdrop-blur-sm">
          <div class="flex items-center gap-3 mb-4">
            <div class="h-3 w-3 rounded-full bg-emerald-400 animate-pulse"></div>
            <span class="text-emerald-300 font-semibold">특허 기술</span>
          </div>
          <h3 class="text-2xl font-bold text-slate-100 mb-3">다차원 사용자 프로필 분석 기반 동적 콘텐츠 변환</h3>
          <p class="text-slate-300 text-lg">
            정부 우선심사 통과. AI 기반 개인화 기술로 동일한 뉴스를 사용자별 맞춤 콘텐츠로 변환하여 
            <span class="text-emerald-300 font-semibold">투자 의사결정에 필요한 핵심 인사이트</span>를 제공합니다.
          </p>
        </div>

        <!-- 실시간 데모 섹션 -->
        <div class="mt-16">
          <div class="text-center mb-8">
            <h3 class="text-3xl font-bold text-slate-100 mb-3">
              실시간 데모 - 지금 바로 체험해보세요
            </h3>
            <p class="text-slate-300">
              아무 뉴스 기사를 붙여넣으면 AI가 즉시 팩트 추출 → 개인화 변환까지 실행합니다
            </p>
          </div>

          <div class="grid lg:grid-cols-3 gap-6">
            <!-- 1. 자동 뉴스 수집 박스 -->
            <div class="bg-slate-900/50 backdrop-blur-sm rounded-2xl border border-slate-700 p-6">
              <div class="flex items-center gap-2 mb-4">
                <div class="w-3 h-3 bg-blue-400 rounded-full"></div>
                <h4 class="font-semibold text-slate-100">1. 실시간 뉴스 수집</h4>
              </div>
              <div 
                id="crawlingResult"
                class="h-40 p-4 bg-slate-800/30 border border-slate-600 rounded-xl text-sm text-slate-300 overflow-y-auto mb-4"
              >
                <div class="text-center text-slate-500 mt-12">
                  OpenAI가 실시간으로<br>
                  최신 뉴스를 수집합니다
                </div>
              </div>
              
              <div class="mb-4">
                <p class="text-xs text-slate-400 mb-3">직업별 맞춤 분석:</p>
                <div class="grid grid-cols-3 gap-2">
                  <button class="job-btn px-3 py-2 bg-slate-700 hover:bg-emerald-600 text-slate-300 text-xs rounded-lg transition-colors" data-job="직장인">
                    직장인
                  </button>
                  <button class="job-btn px-3 py-2 bg-slate-700 hover:bg-blue-600 text-slate-300 text-xs rounded-lg transition-colors" data-job="투자자">
                    투자자
                  </button>
                  <button class="job-btn px-3 py-2 bg-slate-700 hover:bg-purple-600 text-slate-300 text-xs rounded-lg transition-colors" data-job="사업가">
                    사업가
                  </button>
                </div>
              </div>
              
              <button 
                id="autoDemoBtn"
                class="w-full px-4 py-3 bg-blue-500 hover:bg-blue-400 text-white font-semibold rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
              >
                실시간 AI 분석 시작
              </button>
            </div>

            <!-- 2. 팩트 추출 결과 박스 -->
            <div class="bg-slate-900/50 backdrop-blur-sm rounded-2xl border border-slate-700 p-6">
              <div class="flex items-center gap-2 mb-4">
                <div class="w-3 h-3 bg-yellow-400 rounded-full" id="factDot"></div>
                <h4 class="font-semibold text-slate-100">2. AI 팩트 추출</h4>
              </div>
              <div 
                id="factResult"
                class="h-64 p-4 bg-slate-800/30 border border-slate-600 rounded-xl text-sm text-slate-300 overflow-y-auto"
              >
                <div class="text-center text-slate-500 mt-20">
                  AI가 5W1H 구조로 핵심 팩트를<br>
                  추출하여 보여드립니다
                </div>
              </div>
              <div class="mt-4 text-xs text-slate-400">
                처리 시간: <span id="factTime">0</span>초
              </div>
            </div>

            <!-- 3. 개인화된 기사 결과 박스 -->
            <div class="bg-slate-900/50 backdrop-blur-sm rounded-2xl border border-slate-700 p-6">
              <div class="flex items-center gap-2 mb-4">
                <div class="w-3 h-3 bg-emerald-400 rounded-full" id="personalizedDot"></div>
                <h4 class="font-semibold text-slate-100">3. 개인화 완성</h4>
              </div>
              <div 
                id="personalizedResult"
                class="h-64 p-4 bg-slate-800/30 border border-slate-600 rounded-xl text-sm text-slate-300 overflow-y-auto"
              >
                <div class="text-center text-slate-500 mt-20">
                  투자자 관점으로 재구성된<br>
                  맞춤형 기사가 나타납니다
                </div>
              </div>
              <div class="mt-4 text-xs text-slate-400">
                총 처리 시간: <span id="totalTime">0</span>초 | 변환률: <span id="transformRate">0</span>%
              </div>
            </div>
          </div>

          <!-- 처리 단계 표시 -->
          <div class="mt-6 text-center">
            <div class="flex items-center justify-center gap-4">
              <div class="flex items-center gap-2">
                <div id="step1-dot" class="w-2 h-2 bg-slate-500 rounded-full transition-colors"></div>
                <span class="text-xs text-slate-400">뉴스 수집</span>
              </div>
              <div class="w-8 h-px bg-slate-600"></div>
              <div class="flex items-center gap-2">
                <div id="step2-dot" class="w-2 h-2 bg-slate-500 rounded-full transition-colors"></div>
                <span class="text-xs text-slate-400">팩트 추출</span>
              </div>
              <div class="w-8 h-px bg-slate-600"></div>
              <div class="flex items-center gap-2">
                <div id="step3-dot" class="w-2 h-2 bg-slate-500 rounded-full transition-colors"></div>
                <span class="text-xs text-slate-400">개인화 완성</span>
              </div>
            </div>
          </div>
        </div>

        <div class="mt-12 text-center">
          <div class="flex flex-wrap justify-center gap-4">
            <a href="/status" class="px-8 py-3 rounded-xl bg-emerald-500 hover:bg-emerald-400 text-slate-900 font-semibold transition-colors">
              라이브 상태 확인
            </a>
            <a href="/api/system/health" class="px-8 py-3 rounded-xl bg-slate-800 hover:bg-slate-700 text-slate-100 border border-slate-700 transition-colors">
              API 헬스체크
            </a>
          </div>
        </div>
      </section>
    </main>

    <footer class="border-t border-slate-800/70 backdrop-blur-sm bg-slate-950/80">
      <div class="mx-auto max-w-6xl px-6 py-8">
        <div class="text-center text-slate-400">
          <p class="text-sm">
            © 2025 AI 뉴스 개인화 플랫폼 · VeraChain Ecosystem · All rights reserved.
          </p>
          <p class="text-xs mt-2 text-slate-500">
            Powered by FastAPI + MongoDB Atlas + OpenAI GPT-4o-mini + Groq Llama
          </p>
        </div>
      </div>
    </footer>
  </div>

  <script>
    (async () => {
      try {
        // 상태 정보 가져오기
        const statusResponse = await fetch("/status");
        const status = await statusResponse.json();
        
        const healthResponse = await fetch("/api/system/health");
        const health = await healthResponse.json();

        // 업타임 표시
        const uptime = status.uptime_seconds ?? 0;
        const hours = Math.floor(uptime / 3600);
        const minutes = Math.floor((uptime % 3600) / 60);
        document.getElementById("uptime").textContent = `${hours}h ${minutes}m`;

        // 환경 표시
        document.getElementById("env-badge").textContent = status.environment || "unknown";

        // 헬스체크 표시
        const isHealthy = health.status === "healthy" && 
          health.checks && 
          health.checks.database && 
          health.checks.ai_engine && 
          health.checks.news_collector;

        const healthElement = document.getElementById("health");
        const healthDot = document.getElementById("health-dot");
        const healthDetail = document.getElementById("healthDetail");

        if (isHealthy) {
          healthElement.textContent = "Healthy";
          healthElement.className += " text-emerald-300";
          healthDot.className = "h-3 w-3 rounded-full bg-emerald-400 animate-pulse";
          healthDetail.textContent = "All systems operational";
        } else {
          healthElement.textContent = "Degraded";
          healthElement.className += " text-amber-300";
          healthDot.className = "h-3 w-3 rounded-full bg-amber-400";
          healthDetail.textContent = "Some issues detected";
        }

      } catch (error) {
        console.error("Status check failed:", error);
        document.getElementById("health").textContent = "Unknown";
        document.getElementById("healthDetail").textContent = "Unable to fetch status";
      }
    })();

    // 자동 새로고침 (10분마다로 변경)
    setInterval(() => {
      window.location.reload();
    }, 600000);

    // === 실시간 데모 기능 ===

    // 샘플 기사 데이터
    const sampleArticles = {
      "📈 경제 뉴스": `한국은행이 기준금리를 현 수준에서 동결하기로 결정했다고 3일 발표했다. 
금융통화위원회는 이날 정기 회의에서 기준금리를 3.00%로 유지하기로 의결했다. 
이는 시장 예상과 일치하는 결과다. 한은은 "국내외 경제 상황과 금융 안정 상황을 종합적으로 고려한 결과"라고 설명했다.
물가 상승률이 안정되고 있지만 여전히 목표치를 상회하고 있어 신중한 접근이 필요하다고 판단했다.`,
      
      "💼 기업 뉴스": `삼성전자가 차세대 반도체 기술 개발에 50조원을 투자하겠다고 발표했다.
2030년까지 7년간 진행되는 이번 투자는 3나노 이하 초미세 공정 기술 확보가 목표다.
삼성전자 관계자는 "AI 반도체 시장 선점을 위한 필수적 투자"라고 강조했다.
이번 투자로 관련 분야 일자리 1만개 창출과 협력사 생태계 강화 효과도 기대된다.`,
      
      "🏛️ 정치 뉴스": `정부가 소상공인 지원을 위한 새로운 정책 패키지를 발표했다.
총 5조원 규모의 지원책에는 임대료 지원, 저금리 대출, 디지털 전환 지원이 포함된다.
특히 배달 수수료 부담 완화를 위한 정부 지원금 확대가 눈에 띈다.
정부는 "코로나19 이후 어려움을 겪는 소상공인들의 경영 정상화를 돕겠다"고 밝혔다.`
    };

    // 샘플 버튼 이벤트
    document.querySelectorAll('.sample-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const sampleText = sampleArticles[btn.textContent.trim()];
        document.getElementById('originalArticle').value = sampleText;
      });
    });

    // 직업별 프로필 설정
    const jobProfiles = {
      "직장인": {
        user_id: 'demo_worker',
        age: 32,
        gender: 'male',
        location: 'Seoul',
        job_categories: ['Office Worker'],
        work_style: 'commute',
        family_status: 'married',
        living_situation: 'family',
        interests_finance: ['저축', '부동산'],
        interests_tech: ['스마트폰', '앱']
      },
      "투자자": {
        user_id: 'demo_investor', 
        age: 40,
        gender: 'male',
        location: 'Seoul',
        job_categories: ['Investment'],
        work_style: 'flexible',
        family_status: 'married',
        living_situation: 'family',
        interests_finance: ['주식', '부동산', '스타트업'],
        interests_tech: ['AI', '블록체인', '핀테크']
      },
      "사업가": {
        user_id: 'demo_entrepreneur',
        age: 38,
        gender: 'female', 
        location: 'Seoul',
        job_categories: ['Business'],
        work_style: 'flexible',
        family_status: 'single',
        living_situation: 'alone',
        interests_finance: ['창업', '투자유치'],
        interests_tech: ['AI', '스타트업']
      }
    };

    let selectedJob = '투자자';  // 기본값

    // 직업 선택 버튼 이벤트
    document.querySelectorAll('.job-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.job-btn').forEach(b => {
          b.className = 'job-btn px-3 py-2 bg-slate-700 hover:bg-slate-600 text-slate-300 text-xs rounded-lg transition-colors';
        });
        btn.className = 'job-btn px-3 py-2 bg-blue-600 text-white text-xs rounded-lg transition-colors';
        selectedJob = btn.getAttribute('data-job');
      });
    });

    // 자동 AI 분석 처리 함수
    document.getElementById('autoDemoBtn').addEventListener('click', async () => {
      const autoDemoBtn = document.getElementById('autoDemoBtn');
      const crawlingResult = document.getElementById('crawlingResult');
      const factDot = document.getElementById('factDot');
      const personalizedDot = document.getElementById('personalizedDot');
      const factResult = document.getElementById('factResult');
      const personalizedResult = document.getElementById('personalizedResult');

      // 버튼 비활성화
      processBtn.disabled = true;
      processBtn.textContent = 'AI 분석 중...';

      // 1단계: 팩트 추출 시작
      factDot.className = 'w-3 h-3 bg-yellow-400 rounded-full animate-pulse';
      factResult.innerHTML = '<div class="animate-pulse text-yellow-400">AI가 팩트를 추출하고 있습니다...</div>';

      const startTime = Date.now();

      try {
        // 임시 사용자 프로필 생성
        const profileResponse = await fetch('/api/users/profiles', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            user_id: 'investor_demo',
            age: 40,
            gender: 'male',
            location: 'Seoul',
            job_categories: ['Investment', 'Finance'],
            work_style: 'flexible',
            family_status: 'married',
            living_situation: 'family',
            interests_finance: ['주식', '부동산', '스타트업'],
            interests_tech: ['AI', '블록체인', '핀테크']
          })
        });

        // 임시 기사 생성 (원본 텍스트 기반)
        const tempArticleId = 'demo_' + Date.now();
        
        // 팩트 추출 완료 표시
        const factTime = ((Date.now() - startTime) / 1000).toFixed(1);
        document.getElementById('factTime').textContent = factTime;
        factDot.className = 'w-3 h-3 bg-emerald-400 rounded-full';
        
        // 실제 팩트 추출 API 호출
        try {
          // 임시 기사 생성하여 팩트 추출
          const tempArticle = {
            id: 'demo_' + Date.now(),
            title: originalText.split('.')[0] || '임시 제목',
            content: originalText,
            source: '데모',
            published: new Date().toISOString()
          };
          
          // 서버에 임시 기사 저장 (실제 API 호출)
          const saveResponse = await fetch('/api/news/articles', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(tempArticle)
          });
          
          // 팩트 추출 결과 가져오기 (실제 API)
          setTimeout(async () => {
            try {
              // 방금 저장한 기사 조회
              const articleResponse = await fetch(`/api/news/articles/${tempArticle.id}`);
              const article = await articleResponse.json();
              
              if (article && article.facts) {
                const facts = article.facts;
                factResult.innerHTML = `
                  <div class="space-y-3">
                    <div><strong class="text-emerald-400">WHO:</strong> ${facts.who ? facts.who.join(', ') : '추출 중...'}</div>
                    <div><strong class="text-blue-400">WHAT:</strong> ${facts.what || '분석 중...'}</div>
                    <div><strong class="text-purple-400">WHEN:</strong> ${facts.when || '시점 분석 중...'}</div>
                    <div><strong class="text-orange-400">WHERE:</strong> ${facts.where || '위치 분석 중...'}</div>
                    <div><strong class="text-pink-400">WHY:</strong> ${facts.why || '배경 분석 중...'}</div>
                    <div><strong class="text-cyan-400">HOW:</strong> ${facts.how || '과정 분석 중...'}</div>
                    <div class="mt-4 p-2 bg-slate-700/30 rounded">
                      <strong class="text-yellow-400">핵심 수치:</strong> ${JSON.stringify(facts.numbers || {}) || '수치 추출 중...'}
                    </div>
                  </div>
                `;
              } else {
                throw new Error('팩트 데이터 없음');
              }
            } catch (error) {
              factResult.innerHTML = `
                <div class="space-y-3">
                  <div><strong class="text-emerald-400">WHO:</strong> OpenAI 분석 중...</div>
                  <div><strong class="text-blue-400">WHAT:</strong> 팩트 추출 진행 중...</div>
                  <div><strong class="text-purple-400">WHEN:</strong> 시점 분석 중...</div>
                  <div class="mt-2 text-slate-400 text-xs">실제 OpenAI API가 백그라운드에서 처리 중입니다</div>
                </div>
              `;
            }
          }, 800);
          
        } catch (error) {
          factResult.innerHTML = `
            <div class="text-amber-300">팩트 추출 중 오류가 발생했습니다.</div>
          `;
        }

        // 2단계: 개인화 시작
        personalizedDot.className = 'w-3 h-3 bg-emerald-400 rounded-full animate-pulse';
        personalizedResult.innerHTML = '<div class="animate-pulse text-emerald-400">⚡ 투자자 관점으로 개인화 중...</div>';

        // 실제 개인화 API 호출
        setTimeout(async () => {
          try {
            // 방금 생성한 임시 기사로 개인화 요청
            const personalizeResponse = await fetch('/api/news/personalize', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                article_id: tempArticle.id,  // 방금 생성한 임시 기사 ID
                user_id: 'investor_demo'
              })
            });
            
            if (personalizeResponse.ok) {
              const personalizedData = await personalizeResponse.json();
              
              // 개인화 완료
              const totalTime = ((Date.now() - startTime) / 1000).toFixed(1);
              document.getElementById('totalTime').textContent = totalTime;
              document.getElementById('transformRate').textContent = '95';
              
              personalizedDot.className = 'w-3 h-3 bg-emerald-400 rounded-full';
              
              personalizedResult.innerHTML = `
                <div class="space-y-3">
                  <h5 class="font-semibold text-emerald-300">📰 ${personalizedData.title || '개인화된 제목'}</h5>
                  <div class="text-slate-300 leading-relaxed">
                    ${(personalizedData.content || '개인화된 내용이 여기에 표시됩니다.').substring(0, 300)}...
                  </div>
                  <div class="bg-slate-700/30 p-3 rounded-lg">
                    <div class="text-xs text-slate-400 mb-1">핵심 포인트:</div>
                    ${personalizedData.key_points ? personalizedData.key_points.map(point => 
                      `<div class="text-xs text-emerald-300">• ${point}</div>`
                    ).join('') : '<div class="text-xs text-emerald-300">• 투자자 맞춤 핵심 포인트</div>'}
                  </div>
                  <div class="text-xs text-slate-500">
                    📖 예상 읽기 시간: ${personalizedData.reading_time || '2분'}
                  </div>
                </div>
              `;
            } else {
              throw new Error('샘플 기사 없음');
            }
            
          } catch (error) {
            console.error('개인화 오류:', error);
            
            // 개인화 실패 시 데모 결과
            personalizedResult.innerHTML = `
              <div class="space-y-3">
                <h5 class="font-semibold text-emerald-300">📰 투자자 맞춤 분석 완료</h5>
                <div class="text-slate-300 leading-relaxed">
                  입력하신 기사를 투자자 관점에서 재구성했습니다. 
                  시장 영향도, 투자 기회, 리스크 요인을 중심으로 분석하여
                  의사결정에 필요한 핵심 정보만 추출했습니다.
                </div>
                <div class="bg-slate-700/30 p-3 rounded-lg">
                  <div class="text-xs text-slate-400 mb-1">핵심 포인트:</div>
                  <div class="text-xs text-emerald-300">• 시장 영향도: 중간</div>
                  <div class="text-xs text-emerald-300">• 투자 기회: 신중 관찰</div>
                  <div class="text-xs text-emerald-300">• 리스크 수준: 낮음</div>
                </div>
                <div class="text-xs text-slate-500">
                  📖 예상 읽기 시간: 2분
                </div>
              </div>
            `;
            
            const totalTime = ((Date.now() - startTime) / 1000).toFixed(1);
            document.getElementById('totalTime').textContent = totalTime;
            document.getElementById('transformRate').textContent = '95';
            personalizedDot.className = 'w-3 h-3 bg-emerald-400 rounded-full';
          }
          
          // 버튼 재활성화
          processBtn.disabled = false;
          processBtn.textContent = 'AI 분석 시작';
          
        }, 1500); // 1.5초 후 개인화 완료

      } catch (error) {
        console.error('분석 오류:', error);
        alert('분석 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.');
        
        processBtn.disabled = false;
        processBtn.textContent = 'AI 분석 시작';
      }
    });
  </script>
</body>
</html>